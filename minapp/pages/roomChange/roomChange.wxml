<!--pages/roomChange/roomChange.wxml-->
<import src="/zanui/loadmore/index.wxml" />
<view class='container1' style='padding-top:0px;'>
  <view class='zan-panel display-flex justify-space' style='background-color:#fff;margin-top:0px;'>
    <view style='font-size:30rpx;font-weight:600;'>
      <view style='padding:20rpx 30rpx;color:#0B82E6'>西尔曼公寓(广州长隆北门华美国际店)</view>
      <view style='padding:0rpx 30rpx 10px;'>Hi，{{userInfo.nickName}}</view>
    </view>
    <view>
      <image class='userinfo_img' src='{{userInfo.avatarUrl}}'></image>
    </view>
  </view>
  <view class="zan-panel {{queryOrder?'bg-select':''}}" style="padding: 15rpx;margin-top:0px;color:#444;">
    <block wx:if="{{!queryOrder}}">
      <button class="zan-btn zan-btn--small {{manNum==1?'btn-disable':''}} tracs {{addguest?'tracs-on':''}}" data-item='sub' bindtap='addNum' style="margin-right:0px;">－
      </button>
      <button class="zan-btn zan-btn--small" style="margin-right:0px" catchtap='addMan'>
        <image class='icon_img' src='../../images/icon_people.png'></image>{{manNum}}位
      </button>
      <button class="zan-btn zan-btn--small {{manNum==10?'btn-disable':''}} tracs {{addguest?'tracs-on':''}}"  data-item='add' bindtap='addNum'>＋
      </button>
      <button class="zan-btn zan-btn--small {{beginTimeText && endTimeText ? 'chg-text':''}}" bindtap='onClaner'>
        <image class='icon_img' src='../../images/icon-moon.png' wx:if="{{!beginTimeText || !endTimeText}}"></image>{{beginTimeText && endTimeText ? beginTimeText +'至'+ endTimeText:'1晚'}}
      </button>
      <button wx:if="{{!orderInfo}}" class="zan-btn zan-btn--small {{orderInfo?'chg-text':''}}" catchtap='getOrder'>
        <!-- {{orderInfo ? orderInfo.linkman :'我的订单'}} -->
        我的订单
      </button>
       <view style='display:inline-block;position:absolute;top:-2px;'>
        <view wx:key=""  wx:if="{{orderInfo}}" catchtap='cleanOrder' class="demo__icon zan-badge bgcolor-blue" style='height:24px;line-height:24px;font-size:24rpx;background:#0B82E6;color:#fff;padding:2px 10rpx;width:auto;'>
            {{orderInfo.linkman}}<view class="zan-badge__count" style='background:#0B82E6;'>×</view>
        </view>
      </view> 
    </block>
    <block wx:if="{{queryOrder}}" >
      <view style="display:flex">
        <view style='display:flex;background-color:#fff;width:82%;border-radius:10rpx;justify-content:space-between'>
          <input class='zan-field__input zan-cell__bd' style='padding-left:10px;' value="{{keyword}}" bindinput="onPut" placeholder="输入预订人手机号码查找订单"/>
          <image style="width:22px;height:22px;margin:10rpx" catchtap='search' src="../../images/icon-black-select.png"></image> 
        </view>
        <button class='zan-btn zan-btn--small' catchtap="cleanOrder" style='height:34px;line-height:34px'>清除</button>
      </view>
    </block>
  </view>
  <scroll-view enable-back-to-top="true" scroll-y style="height: {{(globalData.SystemInfo.windowHeight-130)}}px" bindscrolltoupper="upper" bindscrolltolower="lower" class="room-scroll-block">
    <!-- 选房 -->
    <block wx:if="{{!queryOrder}}"> 
      <view class="zan-panel" wx:key="" wx:for="{{roomlist}}" data-item="{{item}}" data-index='{{index}}' catchtap='roomSel'>
        <view class="zan-card" style='font-size:24rpx;'>
          <view class="zan-card__thumb" style='font-size:40rpx;height:120rpx;text-align:center;'>
            {{item.roomNo}}
          </view>
          <view class="zan-card__detail">
            <view class="zan-card__detail-row display-flex" style='justify-content:space-between;'>
              <view style='width:200rpx;'>
                <view><text style='background:#0B82E6;color:#fff;padding:4rpx;'>{{item.roomTypeName}}</text></view>
                <view><text style='color:#A02F40;font-weight:600;padding-right:4rpx;'>￥{{item.price}} </text> {{item.area}}㎡</view>
                <view catchtap='onProp' data-item="{{item}}">
                  <image class='icom_prop' wx:key="" wx:for="{{item.property}}" wx:if="{{index<3}}" data-item="{{item}}" data-index="{{index}}" src='{{globalData.imgUrl}}{{item.url}}'></image>
                  <text class='color-blue' wx:if="{{item.property.length>=4}}">＋{{item.property.length-3}}</text>
                </view>
              </view>
              <view class='over-ellipsis-threeline' style='padding-left:20rpx;width:220rpx'>{{item.remark}}</view>
              <view style='padding:4rpx;width:38rpx;height:38rpx;margin-top:30rpx;' data-item='{{item}}' data-index='{{index}}'>
                <view wx:if="{{!item.select}}"  style='border:1rpx #ddd solid;border-radius:50%;width:32rpx;height:32rpx;'>
                </view>
                <image wx:if="{{item.select}}" style='width:100%;height:100%' src='../../images/select-icon.png'></image>
              </view>
            </view>
          </view>
        </view> 
      </view>
      <template is="zan-loadmore" data="{{ loading: loading }}" />
      <view wx:if="{{roomPage.pageEnd}}" style='text-align:center;font-size:24rpx;padding:20rpx;'>~ 没有更多了 ~</view>
    </block>

    <!-- 选订单 -->
    <block wx:if="{{queryOrder}}">
      <view class="zan-panel" wx:key="" wx:for="{{orderlist}}" data-item="{{item}}" data-index='{{index}}' catchtap='orderSel'>
        <view class="zan-card" style='font-size:24rpx;'>
          <view class="">
            <view class="zan-card__detail-row display-flex">
              <view class="zan-card__left-col zan-ellipsis--l2">
                {{item.orderNo}}
              </view>
              <view class="zan-card__right-col">
                ￥{{item.amount}}
              </view>
            </view>
            <view class="zan-card__detail-row zan-c-gray-darker">
              <view class="zan-card__right-col" style='padding:4rpx;width:38rpx;height:38rpx;'>
                <view wx:if="{{!item.select}}"  style='border:1rpx #ddd solid;border-radius:50%;width:32rpx;height:32rpx;'>
                </view>
                <image wx:if="{{item.select}}" style='width:100%;height:100%' src='../../images/select-icon.png'></image>
              </view>
              <view class="zan-card__left-col">
                {{item.linkman}} / {{item.linkphone}}
              </view>
            </view>

            <view class="zan-card__detail-row display-flex">
              <view class="zan-ellipsis--l2">
                {{item.estimateBeginTime}} ~ {{item.estimateEndTime}}
              </view>
            </view>

          </view>
        </view> 
      </view>
      <template is="zan-loadmore" data="{{ loading: loading}}" />
      <view wx:if="{{orderPage.pageEnd}}" style='text-align:center;font-size:24rpx;padding:20rpx;'>~ 没有更多了 ~</view>
    </block>
    <view style='height:120rpx'></view>
  </scroll-view>
  <view class='global-btn-block'>
    <view class='order-btn display-flex' style='color:#bbb;padding:0 20rpx;background:#ddd;'>
        <block wx:if="{{!queryOrder}}">
          <view wx:if="{{roomInfo}}"  data-item='{{roomInfo}}' catchtap='roomSel' class="demo__icon zan-badge" style='height:24px;line-height:24px;background:#0B82E6;color:#fff;width:auto;padding:0 10rpx;'>{{roomInfo.roomNo}}
            <view class="zan-badge__count" style='background:#0B82E6;'>×</view>
          </view>
          <view wx:if="{{!roomInfo}}">
            <image style='width:28rpx;height:28rpx' src='../../images/index.png'></image>请选择房间
          </view>
        </block>
        <block wx:if="{{queryOrder}}">
          <view wx:if="{{orderInfo}}" data-item='{{orderInfo}}' catchtap='orderSel' class="demo__icon zan-badge" style='height:24px;line-height:24px;background:#0B82E6;color:#fff;width:auto;padding:0 10rpx;'>{{orderInfo.linkman}}
            <view class="zan-badge__count" style='background:#0B82E6;'>×</view>
          </view>
          <view wx:if="{{!orderInfo}}" >
            <image class='icon_img'  src='../../images/order.png'></image>请选择订单
          </view>
        </block>
    </view>
     <button class="zan-btn bgcolor-blue" style='color:#fff;width:250rpx;'  bindtap="onBill">确认</button> 
    <!-- <button class="zan-btn bgcolor-blue" style='color:#fff;width:250rpx;'  open-type="getPhoneNumber" bindgetphonenumber="getPhoneNumber">确认</button> -->
  </view>
</view>
