webpackJsonp([16],{"2rlr":function(t,e,o){var i=o("iuVr");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o("rjj0")("1b08ccf2",i,!0)},"5dBV":function(t,e,o){t.exports={default:o("quu5"),__esModule:!0}},"955T":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Modal",{attrs:{title:"查看"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?o("img",{staticStyle:{width:"100%"},attrs:{src:t.imgName}}):t._e()]),t._v(" "),o("Breadcrumb",{staticStyle:{display:"flex","padding-bottom":"20px"}},[o("Breadcrumb-item",{attrs:{href:"/"}},[t._v("首页")]),t._v(" "),o("Breadcrumb-item",{attrs:{href:"#"}},[t._v("门店商品管理")]),t._v(" "),o("Breadcrumb-item",{attrs:{href:"/goodses"}},[t._v("门店商品列表")]),t._v(" "),o("Breadcrumb-item",[t._v("门店商品"+t._s(t.id?"编辑":"新增"))])],1),t._v(" "),o("div",[o("Row",[o("Col",{attrs:{span:"12"}},[o("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":120}},[o("Form-item",{attrs:{label:"分店",prop:""}},[o("Select",{attrs:{placeholder:"请选择输入门店",filterable:""},on:{"on-change":t.changeHotel},model:{value:t.hotelId,callback:function(e){t.hotelId=e},expression:"hotelId"}},t._l(t.inn.allinns,function(e){return o("Option",{key:e.code,attrs:{value:e.code}},[t._v(t._s(e.name))])}))],1),t._v(" "),o("FormItem",{attrs:{label:"商品类型",prop:""}},[o("Select",{attrs:{filterable:"",disabled:t.new_commoditySaveDate.length>0},model:{value:t.categoryIn,callback:function(e){t.categoryIn=e},expression:"categoryIn"}},t._l(t.dicttype.alldicttypes,function(e){return o("Option",{key:e.categoryCode,attrs:{value:e.categoryCode}},[t._v(t._s(e.categoryName))])}))],1)],1)],1)],1),t._v(" "),o("Row",[o("Col",{attrs:{span:"24"}},[o("Table",{attrs:{border:"",columns:t.commoditySaveColumns,data:t.new_commoditySaveDate},on:{"on-selection-change":t.selectCommoidty}})],1)],1),t._v(" "),o("Row",{staticStyle:{"margin-top":"40px"}},[o("Col",{attrs:{span:"24"}},[o("Button",{staticClass:"margin-right-sm",attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("保存")]),t._v(" "),o("Button",{attrs:{type:"ghost"},on:{click:function(e){t.$router.back(-1)}}},[t._v("返回")])],1)],1)],1),t._v(" "),o("Modal",{attrs:{title:"选择商品",width:"1000"},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.changeCommodityShow,callback:function(e){t.changeCommodityShow=e},expression:"changeCommodityShow"}},[o("Table",{ref:"selection",attrs:{border:"",loading:t.loadingCommity,columns:t.commodity,data:t.commodityList},on:{"on-selection-change":t.selectCommoidty}}),t._v(" "),o("Row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"center"}},[o("Col",[o("Page",{attrs:{total:t.page,current:t.initPage},on:{"on-change":t.changePage}})],1)],1)],1)],1)},a=[],n={render:i,staticRenderFns:a};e.a=n},CHlY:function(t,e,o){var i=o("kM2E"),a=o("bs6G");i(i.S+i.F*(Number.parseFloat!=a),"Number",{parseFloat:a})},K4R9:function(t,e,o){o("NA/8"),t.exports=o("FeBl").Number.isNaN},MICi:function(t,e,o){t.exports={default:o("K4R9"),__esModule:!0}},"NA/8":function(t,e,o){var i=o("kM2E");i(i.S,"Number",{isNaN:function(t){return t!=t}})},QIGT:function(t,e,o){"use strict";function i(t){o("2rlr")}Object.defineProperty(e,"__esModule",{value:!0});var a=o("pLHH"),n=o.n(a),r=o("955T"),d=o("VU/8"),s=i,c=d(n.a,r.a,s,null,null);e.default=c.exports},bs6G:function(t,e,o){var i=o("7KvD").parseFloat,a=o("mnVu").trim;t.exports=1/i(o("hyta")+"-0")!=-1/0?function(t){var e=a(String(t),3),o=i(e);return 0===o&&"-"==e.charAt(0)?-0:o}:i},hyta:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},iuVr:function(t,e,o){e=t.exports=o("FZ+f")(!0),e.push([t.i,".avatar{width:200px;height:280px;background:#fff;border-radius:2px}.demo-upload-list{display:inline-block;width:60px;height:60px;text-align:center;line-height:60px;border:1px solid transparent;border-radius:4px;overflow:hidden;background:#fff;position:relative;box-shadow:0 1px 1px rgba(0,0,0,.2);margin-right:4px}.demo-upload-list img{width:100%;height:100%}.demo-upload-list-cover{display:none;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.6)}.demo-upload-list:hover .demo-upload-list-cover{display:block}.demo-upload-list-cover i{color:#fff;font-size:20px;cursor:pointer;margin:0 2px}","",{version:3,sources:["E:/Bee/YumiButler.git/WebUI/src/app/Goodses/Form/index.vue"],names:[],mappings:"AACA,QACE,YAAa,AACb,aAAc,AACd,gBAAoB,AACpB,iBAAmB,CACpB,AACD,kBACE,qBAAsB,AACtB,WAAY,AACZ,YAAa,AACb,kBAAmB,AACnB,iBAAkB,AAClB,6BAA8B,AAC9B,kBAAmB,AACnB,gBAAiB,AACjB,gBAAiB,AACjB,kBAAmB,AACnB,oCAAyC,AACzC,gBAAkB,CACnB,AACD,sBACE,WAAY,AACZ,WAAa,CACd,AACD,wBACE,aAAc,AACd,kBAAmB,AACnB,MAAO,AACP,SAAU,AACV,OAAQ,AACR,QAAS,AACT,yBAA+B,CAChC,AACD,gDACE,aAAe,CAChB,AACD,0BACE,WAAY,AACZ,eAAgB,AAChB,eAAgB,AAChB,YAAc,CACf",file:"index.vue",sourcesContent:["\n.avatar {\n  width: 200px;\n  height: 280px;\n  background: #ffffff;\n  border-radius: 2px;\n}\n.demo-upload-list {\n  display: inline-block;\n  width: 60px;\n  height: 60px;\n  text-align: center;\n  line-height: 60px;\n  border: 1px solid transparent;\n  border-radius: 4px;\n  overflow: hidden;\n  background: #fff;\n  position: relative;\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);\n  margin-right: 4px;\n}\n.demo-upload-list img {\n  width: 100%;\n  height: 100%;\n}\n.demo-upload-list-cover {\n  display: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(0, 0, 0, 0.6);\n}\n.demo-upload-list:hover .demo-upload-list-cover {\n  display: block;\n}\n.demo-upload-list-cover i {\n  color: #fff;\n  font-size: 20px;\n  cursor: pointer;\n  margin: 0 2px;\n}\n"],sourceRoot:""}])},mnVu:function(t,e,o){var i=o("kM2E"),a=o("52gC"),n=o("S82l"),r=o("hyta"),d="["+r+"]",s="​",c=RegExp("^"+d+d+"*"),m=RegExp(d+d+"*$"),l=function(t,e,o){var a={},d=n(function(){return!!r[t]()||s[t]()!=s}),c=a[t]=d?e(h):r[t];o&&(a[o]=c),i(i.P+i.F*d,"String",a)},h=l.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(m,"")),t};t.exports=l},pLHH:function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=o("mvHQ"),n=i(a),r=o("5dBV"),d=i(r),s=o("MICi"),c=i(s),m=o("NYxO"),l=o("ZA0d"),h=i(l),u=o("adDe"),g=i(u),p=o("uRaX"),y=i(p);e.default={name:"form",created:function(){console.log("sssss"),this.id=this.$route.params.id,console.log("val",this.id)},data:function(){var t=this,e=function(t,e,o){(0,c.default)((0,d.default)(e))?o(new Error("请输入数字值")):o()};return{id:"",uploadurl:h.default.API_URL+"/file/uploadFile",uploadparam:{fileType:"goodsPic"},goodsPics:[],goodsPicUrls:["http://img14.360buyimg.com/n1/jfs/t4162/272/378575216/55355/56e7dbca/58b3be82N99650603.jpg"],imgName:"",visible:!1,del:{modal:!1,idx:-1},formValidate:{goodsName:"",originalPrice:"",category:"",innCode:"",pic:""},ruleValidate:{goodsName:[{required:!0,message:"商品名称不能为空"},{max:20,message:"商品名称不能多于 20 个字"}],originalPrice:[{required:!0,message:"售价必须为数字",trigger:"blur"},{validator:e,trigger:"blur"}],category:[{required:!0,message:"商品类别不能为空"}],innCode:[{required:!0,message:"分店不能为空"}],pic:[{required:!0,message:"图片不能为空"}]},categoryIn:[],loadingCommity:!1,commodity:[{type:"selection",width:60,align:"center"},{title:"类型",key:"categoryName"},{title:"商品名称",key:"commodityName",render:function(t,e){return t("Tooltip",{props:{placement:"top"}},[t("a",e.row.commodityName),[t("div",{slot:"content"},[t("img",{attrs:{src:e.row.commodityImg},style:{width:"120px",height:"120px"}},"")])]])}},{title:"商品概要",key:"commoditySynopsis"},{title:"商品售价",key:"commodityPrice"},{title:"商品进货价",key:"commodityCost"}],commodityList:[],page:0,initPage:1,pageData:{pageIdx:0,pageSize:10},hotelId:"",changeCommodity:[],onChangesCommodity:[],changeCommodityShow:!1,commoditySaveDate:[],new_commoditySaveDate:[],commoditySaveColumns:[{title:"类型",key:"categoryName"},{title:"商品名称",key:"commodityName",render:function(t,e){return t("Tooltip",{props:{placement:"top"}},[t("a",e.row.commodityName),[t("div",{slot:"content"},[t("img",{attrs:{src:e.row.commodityImg},style:{width:"120px",height:"120px"}},"")])]])}},{title:"商品概要",key:"commoditySynopsis"},{title:"商品售价",key:"commodityPrice"},{title:"商品进货价",key:"commodityCost"},{title:"商品库存",key:"commodityInventory",render:function(e,o){return e("div",[e("InputNumber",{props:{value:o.row.commodityInventory,min:1},on:{"on-change":function(e){t.commoditySaveDate[o.index].commodityInventory=e,t.$emit("InputNumber",e)}}})])}},{title:"Action",key:"",width:90,align:"center",fixed:"right",render:function(e,o){return e("div",[e("Button",{props:{type:"error",size:"small",disabled:t.editType},on:{click:function(){t.removeCommodity(o.index)}}},"删除")])},renderHeader:function(e,o){return e("div",[e("Button",{props:{type:"primary",size:"small",disabled:t.editType},on:{click:function(){t.addCommodity(o.index)}}},"添加")])}}]}},methods:{get:function(t){this.$store.dispatch("getGoods",{uri:t})},handleSave:function(){var t=this;this.selectOK();if(null==this.hotelId||""==this.hotelId)return void this.$Message.error("请选择门店！");var e=this.new_commoditySaveDate,o=[];for(var i in e)o.push({hotelId:this.hotelId,categoryCode:e[i].commodityCategoryCode,commodityCode:e[i].commodityCode,commodityInventory:e[i].commodityInventory});var a={hotelId:this.hotelId,hotelCategoryList:this.categoryIn,hotelCommoditylist:o};console.log((0,n.default)(a)),a=(0,n.default)(a),(new y.default).addPath("save").POST({data:a}).then(function(e){console.log(e),"ok"==e.data.data?(t.changeCommodity=[],t.onChangesCommodity=[],t.new_commoditySaveDate=[],t.$Message.info("保存成功")):t.$Message.error("保存失败")})},handleView:function(t){this.imgName=t,this.visible=!0},resetFields:function(){this.$refs.formValidate.resetFields()},serch:function(){var t=this;t.loadingCommity=!0;var e={pageIdx:t.pageData.pageIdx,pageSize:t.pageData.pageSize,categoryCodes:t.categoryIn};(new g.default).addPath("in").GET({params:e}).then(function(e){if(1==e.data.success){t.page=e.data.data.totalElements;var o=e.data.data.content,i=o;if(t.commoditySaveDate.length>0)for(var a in i)for(var n in t.commoditySaveDate)i[a].commodityCode==t.commoditySaveDate[n].commodityCode&&(console.log("sss"),i[a]._disabled=!0);if(t.changeCommodity.length>0)for(var r in i)for(var d in t.changeCommodity)i[r].commodityCode==t.changeCommodity[d].commodityCode&&(i[r]._checked=!0);t.commodityList=i,t.loadingCommity=!1}else t.$Message.error("查询失败！"),t.loadingCommity=!1})},changePage:function(t){this.selectOK(),this.initPage=t,this.pageData.pageIdx=t-1,this.serch()},selectCommoidty:function(t){this.onChangesCommodity=t;for(var e in this.commodityList){this.commodityList[e]._checked=!1;for(var o in t)this.commodityList[e].commodityCode==t[o].commodityCode&&(this.commodityList[e]._checked=!0)}},selectOK:function(){for(var t in this.commodityList)if(1==this.commodityList[t]._checked){this.selectTab=!1;for(var e in this.changeCommodity)this.commodityList[t].commodityCode==this.changeCommodity[e].commodityCode&&(this.selectTab=!0);this.selectTab||this.changeCommodity.push(this.commodityList[t])}else for(var e in this.changeCommodity)this.commodityList[t].commodityCode==this.changeCommodity[e].commodityCode&&this.changeCommodity.splice(e,1)},addCommodity:function(){if(0==this.categoryIn.length)return void this.$Message.error("请先选择商品类型！");this.selectOK(),this.pageData={pageIdx:0,pageSize:10},this.initPage=1,this.serch(),this.changeCommodityShow=!0},ok:function(){this.selectOK(),this.new_commoditySaveDate=this.changeCommodity},cancel:function(){this.changeCommodity=[],this.changeCommodityShow=!1},removeCommodity:function(t){console.log(t),this.new_commoditySaveDate.splice(t,1)},changeHotel:function(){var t=this;console.log(this.hotelId);var e=this.hotelId;(new g.default).addPath("hotelCommodity?hotelID="+e).GET().then(function(e){console.log(e),1==e.data.success&&(t.commoditySaveDate=e.data.data)})}},computed:(0,m.mapState)(["goods","inn","dicttype"]),watch:{"goods.goods":{handler:function(t){this.$set(this,"formValidate",t.data)}},goodsPics:{handler:function(t){var e=[];t.forEach(function(t,o){e.push(h.default.STATIC_URL+"/goodsPic/"+t)}),this.$set(this,"goodsPicUrls",e),this.$set(this.formValidate,"pic",t.join(","))}}}}},quu5:function(t,e,o){o("CHlY"),t.exports=parseFloat}});
//# sourceMappingURL=16.42024adfd5ad7db03aaa.js.map